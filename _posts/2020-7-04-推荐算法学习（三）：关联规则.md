---
published: true
title: 推荐算法学习（三）：关联规则
category: 推荐算法
tags: 
  - 推荐系统
layout: post
---

关联规则是反映一个事物与其他事物之间的相互依存性和关联性，如果两个或多个事物之间存在一定的关联关系，那么，其中一个事物就能通过其他事物预测到。关联规则是数据挖掘的一个重要技术，用于从大量数据中挖掘出有价值的数据项之间的相关关系。

关联规则挖掘的最经典案例就是沃尔玛的啤酒与尿布的故事，通过对超市购物小票进行分析，发现顾客买尿布时会顺便购买啤酒，超市就把尿布和啤酒放在一起销售增加销售额。关联分析的使用场景非常广泛，除了超市购物这一典型场景，电影分类也可进行关联分析，每部电影的分类可以看做一个购物小票（Transaction），进而可以挖掘电影种类中的关联规则。

关联规则与协同过滤都是基于大众的行为数据展开分析，两者的区别在于关联规则是基于当前一次的购买/点击，即当下的需求；协同过滤是基于用户历史的行为进行分析，建立一定时间内的偏好排序，即长期偏好。两种推荐算法的思考维度不同，很多时候，我们需要把多种推荐方法的结果综合起来做一个混合的推荐。 



## 基本概念

* **支持度**：指的是某个商品组合出现的次数与总次数之间的比例

* **置信度**：指的是当你购买了商品A，会有多大的概率购买商品B（条件概念）

* **提升度**：商品A的出现，对商品B的出现概率提升的程度，提升度(A→B)=置信度(A→B)/支持度(B)

## Apriori算法

**频繁项集**：支持度大于等于最小支持度(Min Support)阈值的项集

**非频繁项集**：支持度小于最小支持度的项集

**Apriori算法流程**：

* Step1，K=1，计算K项集的支持度；

* Step2，筛选掉小于最小支持度的项集；

* Step3，如果项集为空，则对应K-1项集的结果为最终结果；否则K=K+1，重复1-3步。


下表中用ID来代表商品，ID1-6分别代表牛奶、面包、尿布、可乐、啤酒、鸡蛋。![0](https://raw.githubusercontent.com/Alice1214/alice1214.github.io/master/_posts/image/推荐算法（三）/0.png)

利用Apriori算法查找频繁项集(frequent itemset)的过程如下：

先计算K=1项的支持度![1](https://raw.githubusercontent.com/Alice1214/alice1214.github.io/master/_posts/image/推荐算法（三）/1.png)

假设最小支持度=0.5，那么Item4和6不符合最小支持度的，不属于频繁项集![2](https://raw.githubusercontent.com/Alice1214/alice1214.github.io/master/_posts/image/推荐算法（三）/2.png)

在这个基础上，我们将商品两两组合，得到k=2项的支持度![3](https://raw.githubusercontent.com/Alice1214/alice1214.github.io/master/_posts/image/推荐算法（三）/3.png)

筛选掉小于最小值支持度的商品组合![4](https://raw.githubusercontent.com/Alice1214/alice1214.github.io/master/_posts/image/推荐算法（三）/4.png)

将商品进行K=3项的商品组合，可以得到：![5](https://raw.githubusercontent.com/Alice1214/alice1214.github.io/master/_posts/image/推荐算法（三）/5.png)

筛选掉小于最小值支持度的商品组合![6](https://raw.githubusercontent.com/Alice1214/alice1214.github.io/master/_posts/image/推荐算法（三）/6.png)

得到K=3项的频繁项集{1,2,3}，也就是{牛奶、面包、尿布}的组合。

## FPGrowth算法（FP树来存储频繁项集，import fptools as fp）





## 实例：基于标签做书签URL的推荐

* **Delicious2K数据集**：user_taggedbookmarks-timestamps.dat（该文件包含每个用户提供的书签URL的标签分配及完成标签分配的时间戳）。

* **分别采用NormTagBased算法和TagBased-TFIDF算法，基于标签计算用户对书签的兴趣，并对用户推荐Top-N书签。**

>github地址：<https://github.com/Alice1214/RS/tree/master/RS02/delicious>

![0](https://raw.githubusercontent.com/Alice1214/alice1214.github.io/master/_posts/image/推荐算法（三）/0.png)
